---
import Search from "@/components/Search.astro";
import ThemeToggle from "@/components/ThemeToggle.astro";
import { menuLinks } from "@/site.config";
---

<header class="group relative mb-16 flex items-center sm:ps-[4.5rem]" id="main-header">
	<div class="flex sm:flex-col">
		<a
			aria-current={Astro.url.pathname === "/" ? "page" : false}
			class="inline-flex items-center grayscale hover:filter-none sm:relative sm:inline-block"
			href="/"
		>
			<!-- 自定义图片 -->
			<!-- <img
				src="/logo.jpg"
				alt="Logo"
				class="me-3 h-10 w-10 sm:absolute sm:start-[-5rem] sm:top-[-0.4rem] sm:me-0 sm:h-16 sm:w-16"
			/> -->
			<!-- 自定义svg -->
			<svg
				version="1.0"
				xmlns="http://www.w3.org/2000/svg"
				width="638.000000pt"
				height="638.000000pt"
				viewBox="0 0 638.000000 638.000000"
				preserveAspectRatio="xMidYMid meet"
				class="me-3 h-10 w-10 sm:absolute sm:start-[-5rem] sm:top-[-0.4rem] sm:me-0 sm:h-16 sm:w-16"
			>
				<g
					transform="translate(0.000000,638.000000) scale(0.100000,-0.100000)"
					fill="#000000"
					stroke="none"
				>
					<path
						d="M2438 4345 c-4 -4 -4 -13 -2 -20 3 -8 -7 -15 -30 -19 -20 -4 -36 -12
-36 -17 0 -6 -9 -7 -21 -4 -23 8 -69 -28 -69 -53 0 -9 -6 -12 -15 -8 -10 4
-22 -5 -34 -24 -10 -17 -20 -27 -24 -24 -3 3 -12 -3 -19 -15 -7 -12 -17 -21
-23 -21 -5 0 -26 -16 -45 -35 -19 -19 -40 -35 -46 -35 -7 0 -14 -6 -17 -12 -3
-10 -8 -8 -18 4 -18 22 -64 39 -84 32 -8 -4 -27 -3 -43 1 -25 7 -26 8 -7 16
15 7 9 8 -19 5 -28 -4 -47 0 -65 13 -46 32 -92 41 -190 36 -65 -4 -100 -10
-111 -20 -11 -10 -41 -17 -77 -19 -33 -1 -74 -10 -93 -19 -18 -10 -41 -17 -51
-17 -10 0 -21 -4 -24 -10 -13 -20 -42 -9 -89 35 -27 25 -55 45 -62 45 -7 0
-21 10 -31 23 -10 13 -24 22 -30 20 -7 -3 -18 7 -24 20 -7 15 -17 23 -25 20
-10 -4 -12 0 -8 11 5 13 0 16 -22 16 -41 -2 -97 10 -109 22 -7 8 -6 9 3 4 6
-4 12 -3 12 2 0 10 -38 13 -77 6 -13 -3 -23 -11 -23 -20 0 -11 -6 -13 -20 -9
-14 5 -20 2 -20 -9 0 -16 -11 -20 -39 -16 -8 1 -12 -4 -8 -14 3 -8 -1 -20 -9
-27 -8 -7 -12 -20 -8 -31 4 -14 -1 -25 -15 -35 -28 -19 -71 -87 -71 -112 0
-11 -4 -23 -10 -26 -5 -3 -10 -14 -10 -24 0 -10 -10 -30 -21 -45 -12 -15 -19
-29 -16 -32 3 -3 -1 -21 -9 -39 -8 -19 -14 -51 -14 -70 0 -22 -4 -34 -10 -30
-5 3 -10 -2 -10 -12 0 -11 -4 -23 -9 -28 -14 -16 -20 -93 -7 -99 6 -2 4 -5 -5
-5 -16 -1 -32 -27 -44 -69 -6 -21 -4 -23 14 -17 16 5 15 0 -10 -26 -17 -18
-38 -50 -46 -71 -8 -21 -21 -38 -27 -38 -16 0 -68 -79 -60 -91 3 -5 -2 -9 -10
-9 -9 0 -16 -4 -16 -10 0 -19 -2 -25 -10 -35 -5 -6 -11 -24 -14 -40 -3 -15 -9
-31 -13 -34 -5 -3 -16 -37 -25 -75 -12 -54 -13 -74 -5 -88 10 -15 9 -21 -2
-27 -10 -6 -14 -27 -13 -68 1 -59 3 -73 20 -129 11 -36 1 -60 -22 -51 -8 3
-18 2 -21 -2 -5 -9 -37 -8 -123 4 l-52 8 0 -1377 0 -1376 3190 0 3190 0 0
1404 0 1405 -33 -6 c-24 -3 -39 0 -50 12 -19 19 -22 13 -7 -16 13 -23 -2 -26
-20 -4 -10 12 -16 13 -26 4 -11 -9 -14 -8 -14 5 0 21 -53 22 -74 0 -13 -13
-16 -13 -16 -1 0 12 -15 14 -77 11 -44 -2 -79 -8 -84 -15 -5 -9 -15 -9 -39 0
-41 14 -53 14 -45 1 9 -14 -2 -12 -28 4 -23 15 -43 16 -64 3 -6 -4 -14 -3 -18
3 -3 5 -19 7 -35 3 -18 -3 -36 0 -45 7 -9 7 -18 10 -22 6 -3 -3 -1 -6 6 -6 7
0 9 -5 6 -10 -4 -6 -10 -8 -14 -6 -17 11 -127 17 -182 11 -45 -5 -59 -11 -55
-21 4 -11 -3 -13 -29 -9 -28 3 -35 1 -36 -13 0 -12 -3 -10 -10 6 -6 17 -14 22
-28 17 -12 -4 -23 0 -28 9 -5 9 -20 16 -33 15 -14 0 -42 0 -62 0 -20 1 -39 -3
-42 -8 -3 -5 -22 -5 -41 -1 -21 5 -38 4 -41 -2 -3 -5 -19 -6 -35 -3 -15 4 -36
2 -46 -3 -10 -6 -26 -7 -41 -1 -16 6 -29 6 -38 -2 -10 -8 -14 -8 -14 0 0 17
-30 13 -37 -5 -4 -12 -14 -14 -40 -9 -22 4 -40 2 -51 -7 -13 -11 -15 -11 -9 5
5 12 1 17 -13 17 -11 0 -20 5 -20 11 0 8 -4 8 -13 1 -16 -14 -68 -19 -84 -9
-7 5 -9 0 -6 -14 4 -16 2 -20 -8 -17 -8 3 -13 12 -12 19 2 9 -5 15 -17 15 -14
0 -19 -5 -15 -16 4 -11 1 -10 -9 3 -15 20 -72 23 -79 5 -4 -10 -6 -10 -6 0 -1
15 -33 16 -48 1 -8 -8 -13 -8 -17 0 -11 18 -26 13 -20 -6 4 -14 1 -12 -13 4
-15 19 -23 21 -54 14 -19 -4 -60 -6 -90 -3 l-54 4 19 -21 c19 -21 19 -21 -7
-21 -14 0 -30 6 -34 14 -13 23 -58 30 -76 12 -17 -18 -32 -21 -22 -6 4 6 -5
10 -22 10 -15 0 -44 1 -63 3 -41 5 -72 -2 -64 -14 3 -5 -4 -9 -16 -9 -12 0
-19 4 -16 9 8 12 -50 19 -88 10 -17 -4 -23 -7 -13 -8 9 -1 17 -5 17 -10 0 -12
-43 -1 -52 13 -6 8 -11 6 -18 -4 -9 -13 -11 -13 -20 0 -8 12 -12 13 -19 2 -6
-11 -10 -10 -15 3 -5 15 -9 14 -26 -6 -14 -17 -18 -19 -14 -6 8 21 -6 22 -32
1 -10 -8 -13 -13 -6 -9 7 4 12 0 12 -11 0 -13 -3 -14 -15 -4 -8 7 -15 18 -15
25 0 12 -36 11 -70 -2 -8 -4 -19 -5 -24 -4 -4 1 -15 -4 -24 -11 -12 -10 -14
-10 -8 0 4 6 3 12 -3 12 -5 0 -13 -5 -16 -11 -4 -6 -13 -8 -20 -5 -7 2 -18 -8
-25 -22 -9 -19 -14 -23 -18 -12 -3 7 0 16 7 18 18 6 13 22 -8 22 -11 0 -22 6
-24 13 -4 9 -8 9 -16 -3 -12 -17 -4 -33 12 -23 7 4 6 -1 -2 -11 -8 -9 -17 -13
-20 -7 -3 5 -20 11 -38 14 -17 3 -36 8 -41 11 -5 3 -12 -4 -15 -15 -3 -12 -10
-18 -16 -14 -6 3 -9 10 -6 15 11 18 -8 41 -30 36 -20 -5 -21 -2 -19 40 2 25 7
51 13 57 16 20 10 159 -7 180 -11 12 -12 21 -5 28 12 12 -17 147 -34 157 -6 4
-13 26 -16 48 -4 45 -43 118 -58 108 -5 -3 -9 2 -9 11 0 18 -58 75 -77 75 -6
0 -14 9 -18 20 -3 11 -20 33 -36 50 -17 16 -23 27 -15 24 21 -8 22 38 2 55 -8
7 -22 38 -32 69 -9 31 -24 65 -32 74 -7 9 -11 21 -8 27 3 5 1 11 -5 13 -6 2
-13 22 -15 43 -3 22 -11 45 -19 51 -8 6 -15 18 -15 27 0 8 -6 28 -14 44 -24
46 -46 100 -46 112 0 6 -4 11 -10 11 -5 0 -10 7 -10 15 0 8 -17 28 -39 45 -25
21 -37 37 -34 49 2 10 -2 23 -11 30 -8 7 -12 19 -9 28 5 12 1 14 -16 8 -14 -4
-23 -2 -27 9 -3 9 -14 16 -24 16 -10 0 -21 7 -24 16 -5 12 -14 15 -40 10 -21
-4 -36 -2 -38 4 -2 6 -6 8 -10 5z m-331 -1021 c18 -29 22 -169 4 -202 -19 -35
-44 -44 -79 -27 -28 14 -30 20 -37 90 -4 48 -3 87 5 110 21 64 74 78 107 29z
m-707 8 c18 -15 23 -31 26 -92 3 -41 7 -80 9 -87 2 -7 0 -15 -5 -18 -6 -4 -10
-13 -10 -21 0 -24 -34 -53 -59 -51 -49 3 -72 117 -44 222 14 55 21 65 39 65
12 0 32 -8 44 -18z m2487 -557 c0 -11 -4 -12 -14 -4 -7 6 -13 13 -13 15 0 2 6
4 13 4 8 0 14 -7 14 -15z m-294 -22 c-7 -2 -21 -2 -30 0 -10 3 -4 5 12 5 17 0
24 -2 18 -5z m127 -3 c0 -5 -5 -10 -11 -10 -5 0 -7 5 -4 10 3 6 8 10 11 10 2
0 4 -4 4 -10z m-530 -10 c0 -5 -5 -10 -11 -10 -5 0 -7 5 -4 10 3 6 8 10 11 10
2 0 4 -4 4 -10z"
					></path>
					<path
						d="M5364 2814 c3 -9 6 -17 6 -19 0 -2 9 -1 19 2 25 6 16 33 -11 33 -14
0 -18 -5 -14 -16z"
					></path>
				</g>
			</svg>
			<!-- 修改：首页标题 -->
			<span class="text-xl font-bold sm:text-2xl">akary's Blog</span>
		</a>
		<nav
			aria-label="Main menu"
			class="absolute -inset-x-4 top-14 hidden flex-col items-end gap-y-4 rounded-md bg-bgColor/[.85] py-4 text-accent shadow backdrop-blur group-[.menu-open]:z-50 group-[.menu-open]:flex sm:static sm:z-auto sm:-ms-4 sm:mt-1 sm:flex sm:flex-row sm:items-center sm:divide-x sm:divide-accent sm:rounded-none sm:bg-transparent sm:py-0 sm:shadow-none sm:backdrop-blur-none"
			id="navigation-menu"
		>
			{
				menuLinks.map((link) => (
					<a
						aria-current={Astro.url.pathname === link.path ? "page" : false}
						class="px-4 py-4 underline-offset-2 sm:py-0 sm:hover:underline"
						data-astro-prefetch
						href={link.path}
					>
						{link.title}
					</a>
				))
			}
		</nav>
	</div>
	<Search />
	<ThemeToggle />
	<mobile-button>
		<button
			aria-expanded="false"
			aria-haspopup="menu"
			aria-label="Open main menu"
			class="group relative ms-4 h-7 w-7 sm:invisible sm:hidden"
			id="toggle-navigation-menu"
			type="button"
		>
			<svg
				aria-hidden="true"
				class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 transition-all group-aria-expanded:scale-0 group-aria-expanded:opacity-0"
				fill="none"
				focusable="false"
				id="line-svg"
				stroke="currentColor"
				stroke-width="1.5"
				viewBox="0 0 24 24"
				xmlns="http://www.w3.org/2000/svg"
			>
				<path d="M3.75 9h16.5m-16.5 6.75h16.5" stroke-linecap="round" stroke-linejoin="round"
				></path>
			</svg>
			<svg
				aria-hidden="true"
				class="absolute start-1/2 top-1/2 h-full w-full -translate-x-1/2 -translate-y-1/2 scale-0 text-accent opacity-0 transition-all group-aria-expanded:scale-100 group-aria-expanded:opacity-100"
				class="text-accent"
				fill="none"
				focusable="false"
				id="cross-svg"
				stroke="currentColor"
				stroke-width="1.5"
				viewBox="0 0 24 24"
				xmlns="http://www.w3.org/2000/svg"
			>
				<path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round"></path>
			</svg>
		</button>
	</mobile-button>
</header>

<script>
	import { toggleClass } from "@/utils/domElement";

	class MobileNavBtn extends HTMLElement {
		#menuOpen: boolean = false;

		connectedCallback() {
			const headerEl = document.getElementById("main-header")!;
			const mobileButtonEl = this.querySelector<HTMLButtonElement>("button");

			mobileButtonEl?.addEventListener("click", () => {
				if (headerEl) toggleClass(headerEl, "menu-open");
				this.#menuOpen = !this.#menuOpen;
				mobileButtonEl.setAttribute("aria-expanded", this.#menuOpen.toString());
			});
		}
	}

	customElements.define("mobile-button", MobileNavBtn);
</script>
